<!DOCTYPE html><html><head><link rel="stylesheet" href="https://github.githubassets.com/assets/frameworks-a2fba223d5af91496cac70d4ec3624df.css"><link rel="stylesheet" href="https://github.githubassets.com/assets/github-6556dfa9be535e551ffffaadfecdad99.css"><link rel="prefetch" href="https://cdn.staticfile.org/jqueryui/1.12.1/jquery-ui.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/marked/0.6.2/marked.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/react/16.9.0-alpha.0/umd/react.production.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/react-router-dom/5.0.0/react-router-dom.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/react-dom/16.8.6/umd/react-dom.production.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/big-integer/1.6.43/BigInteger.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/decimal.js/10.2.0/decimal.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/clipboard.js/2.0.4/clipboard.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/vue/2.6.10/vue.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/vue-router/3.0.6/vue-router.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/fast-xml-parser/3.12.16/parser.min.js"><link rel="prefetch" href="https://cdn.staticfile.org/highlight.js/9.15.6/highlight.min.js"><link rel="prefetch" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"><link rel="prefetch" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/extensions/MathMenu.js"><link rel="prefetch" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/extensions/MathZoom.js"><style>body,html{scroll-behavior:smooth}</style><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script>$(window).one("load",function(){$("#my主体").css("padding-top",$("#my导航栏").height())});</script><script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js" async></script><link rel="icon" href="/favicon.816406fa.ico" type="img/x-ico"><script src="https://cdn.staticfile.org/mui/3.7.1/js/mui.min.js" async></script><link rel="stylesheet" href="https://cdn.staticfile.org/mui/3.7.1/css/mui.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title> masx200的github-点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新 </title><link rel="stylesheet" href="/myindexrender.c7ca946c.css"><script src="/点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新.4e48f6ce.js"></script></head><body>  <div id="my导航栏" class="fixed-top container-fluid"> <nav class="navbar navbar-expand-sm bg-light navbar-light">  <div> <a class="navbar-brand" href="https://masx200.github.io/">masx200的github主页</a>  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar"> <span class="navbar-toggler-icon"></span> </button>   </div> <div class="collapse navbar-collapse" id="collapsibleNavbar"> <ul class="navbar-nav"> <li class="nav-item"> <a href="https://masx200.github.io/圆周率计算-可设置圆周率位数-可选择线程个数-多线程大数框架webworker输出useragent大数框架/index.html" class="nav-link">圆周率计算多线程 </a> </li> <li class="nav-item"> <a href="https://masx200.github.io/花密网页版-完善修改版-响应式的导航栏/index.html" class="nav-link">花密网页版 </a> </li> <li class="nav-item"> <a href="https://masx200.github.io/my-vue-router-project/index.html" class="nav-link">基于VUE的主页 </a> </li> <li class="nav-item"> <a href="https://masx200.github.io/my-react-router-test/index.html" class="nav-link">基于REACT的主页 </a> </li> <li class="nav-item"> <a href="https://masx200.github.io/JSfuck-and-hieroglyphy-Decoder-and-ENCODER/index.html" class="nav-link">JSfuck-and-hieroglyphy-Decoder-and-ENCODER </a> </li> </ul> </div> </nav>  </div> <div id="my主体" class="container" style="min-width:100%;padding-top:53px;"> <div class="jumbotron"> <h1>欢迎登陆页面！</h1> <br> <h2>点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新</h2> <br> <p> <b> <a target="_blank" href="https://weibo.com/2174458781?">一生忽而得一夏当司掌好年华的微博 </a> </b> </p> <p> <b> <a target="_blank" href="https://github.com/masx200">masx200的github仓库 </a> </b> </p> <p> <b> <a target="_blank" href="https://masx200.github.io/ditto/">masx200的ditto: 轻量级markdown文档系统阅读器 </a> </b> </p> <p> <b> <a target="_blank" href="https://masx200.github.io/javascript-tutorial/">javascript教程,基于ditto的markdown阅读器 </a> </b> </p> <p> <b> <a target="_blank" href="https://masx200.github.io/es6tutorial/">ecmascript6教程,基于ditto的markdown阅读器 </a> </b> </p> </div> <div>  <div id="readme" class="Box Box--condensed instapaper_body md js-code-block-container"> <div class="Box-header d-flex flex-items-center flex-justify-between px-2"> <h3 class="Box-title pr-3"> <svg class="octicon octicon-book" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"/></svg> readme.md </h3> <div> <a href="https://github.com/masx200/masx200.github.io/edit/master/src/readme.md" class="Box-btn-octicon btn-octicon float-right" aria-label="Edit this file"><svg class="octicon octicon-pencil" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"/></svg></a> </div> </div> <div class="Box-body" style="padding:0;"> <article class="markdown-body entry-content p-5" itemprop="text" style="padding:0;"> <h1> <a id="user-content-点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新的脚本" class="anchor" aria-hidden="true" href="https://github.com/masx200/masx200.github.io/tree/master/src#%E7%82%B9%E5%87%BB%E9%93%BE%E6%8E%A5%E4%B8%8D%E8%B7%B3%E8%BD%AC-%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E9%A1%B5%E5%9C%B0%E5%9D%80-%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E4%B8%8D%E5%88%B7%E6%96%B0%E7%9A%84%E8%84%9A%E6%9C%AC"><svg class="octicon octicon-link" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新的脚本 </h1> <p> <a href="https://github.com/masx200/masx200.github.io/blob/master/src/index-%E7%82%B9%E5%87%BB%E9%93%BE%E6%8E%A5%E4%B8%8D%E8%B7%B3%E8%BD%AC-%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E9%A1%B5%E5%9C%B0%E5%9D%80-%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E4%B8%8D%E5%88%B7%E6%96%B0.html">源代码 html</a> </p> <p> <a href="https://github.com/masx200/masx200.github.io/blob/master/src/%E7%82%B9%E5%87%BB%E9%93%BE%E6%8E%A5%E4%B8%8D%E8%B7%B3%E8%BD%AC-%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E9%A1%B5%E5%9C%B0%E5%9D%80-%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E4%B8%8D%E5%88%B7%E6%96%B0.js">源代码 js</a> </p> <p> <a href="https://github.com/masx200/masx200.github.io/blob/master/src/readme.md">https://github.com/masx200/masx200.github.io/blob/master/src/readme.md</a> </p> <p> <a href="https://masx200.github.io/src/index-%E7%82%B9%E5%87%BB%E9%93%BE%E6%8E%A5%E4%B8%8D%E8%B7%B3%E8%BD%AC-%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E9%A1%B5%E5%9C%B0%E5%9D%80-%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E4%B8%8D%E5%88%B7%E6%96%B0.html" rel="nofollow">https://masx200.github.io/src/index-%E7%82%B9%E5%87%BB%E9%93%BE%E6%8E%A5%E4%B8%8D%E8%B7%B3%E8%BD%AC-%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E9%A1%B5%E5%9C%B0%E5%9D%80-%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E4%B8%8D%E5%88%B7%E6%96%B0.html</a> </p> <h2> <a id="user-content-介绍大概和注意" class="anchor" aria-hidden="true" href="https://github.com/masx200/masx200.github.io/tree/master/src#%E4%BB%8B%E7%BB%8D%E5%A4%A7%E6%A6%82%E5%92%8C%E6%B3%A8%E6%84%8F"><svg class="octicon octicon-link" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>介绍大概和注意 </h2> <p>点击链接不跳转修改当前的网页地址动态加载网页内容不刷新</p> <p> 这个脚本能够通过异步 fetch 加载 html 页面,动态替换当前的页面内容 </p> <p> 注意 不能跨域 ,history.pushState 函数是改变地址栏的 url,有同源限制 </p> <p> 注意:对于使用了 document.write 的网站, 加载会出错,因为脚本都是异步加载的,网页内容会被覆盖,所以 修改了 document.write 方法 </p> <h2> <a id="user-content-预先的准备工作" class="anchor" aria-hidden="true" href="https://github.com/masx200/masx200.github.io/tree/master/src#%E9%A2%84%E5%85%88%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><svg class="octicon octicon-link" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>预先的准备工作 </h2> <p> 0.添加css样式"body, html { scroll-behavior: smooth;}"就可以实现平滑滚动 </p> <p> 1.把当前页面的网址的 href 写入到 docment 的 html 的 dataset 当中 </p> <p> 2.修改 document.write 方法为 把 document.write 中的文本内容生成 dom 元素放入 body 之中 </p> <p> 3.替换所有同源的 a 链接的 href 为"javascript:;" ,把原本 href 存到元素的 dataset 中,设置 a 链接的 click 事件监听器,点击时触发 ,修改当前网页地址栏网址,触发 popstate 事件 </p> <p> 4.设置 popstate 事件监听器,收到此事件时,开始动态加载网页执行顺序,当点击浏览器的前进和后退按钮时,自动触发 popstate 事件 </p> <h2> <a id="user-content-动态加载网页执行顺序" class="anchor" aria-hidden="true" href="https://github.com/masx200/masx200.github.io/tree/master/src#%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%BD%91%E9%A1%B5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><svg class="octicon octicon-link" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>动态加载网页执行顺序 </h2> <p>1.开始发起 fetch 异步请求 url 的 html 内容</p> <p> 2.获取返回头部的编码信息和文件类型信息,如果这里没有编码信息,则在转成文字之后查找 meta 中 charset 和 meta 的 Content-Type 中的 charset </p> <p> 3.把返回的 arraybuffer 解码成文字,然后转成 html 的 document 对象,如果加载失败则新窗口打开请求的页面 </p> <p>4.复制接收的 html 的 body 的内容到当前网页的 body 当中</p> <p> 5.添加其他标签到 head 中,不包括 link 的 stylesheet 和 script </p> <p> 6.1.线程 1-添加有 href 的 link 的 stylesheet 到 head 中,从外部加载的全部改成异步加载,当他们加载完成时,触发 window 的 allstylesheetload 事件,然后删除旧的 stylesheet 和 script 元素 和其他元素 </p> <p> 6.2.线程 2-添加有 src 的 script 的 javascript 到 head 中,从外部加载的全部改成异步加载,当他们加载完成时,触发 window 的 allscriptloadformsrc 事件,加载用文本内容加载的 javascript 到 head 执行,触发"alltextscriptload"事件,然后再触发 window 的 load 事件 </p> </article> </div> </div> </div> </div> </body></html>