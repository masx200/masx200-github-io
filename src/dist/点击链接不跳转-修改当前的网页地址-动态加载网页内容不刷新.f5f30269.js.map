{"version":3,"sources":["点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新.js"],"names":["window","addEventListener","windowloadhandler","document","charset","removeEventListener","htmldataboject","Object","Array","querySelectorAll","forEach","e","src","firstElementChild","dataset","href","location","pathname","console","log","替换a链接","alinkarr","from","getElementsByTagName","hostname","onclick","动态加载网页内容不刷新","onpopstatehandler","script总数量","script完成数量","script加载完成","urlortext","setTimeout","dispatchEvent","Event","loadscript","fileurl","loadguid","guid","callback","undefined","script","createElement","loadid","type","onload","async","onerror","appendChild","loadscripttext","text","innerHTML","loadstyle","rel","replace","t","Math","random","toString","fetchhandler","sr","myhtmldata","DOMParser","parseFromString","URL","url","title","length","parentNode","removeChild","protocal","protocol","history","pushState","nowurl","fetch","then","r","error"],"mappings":"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","file":"点击链接不跳转-修改当前的网页地址-动态加载网页内容不刷新.f5f30269.js","sourceRoot":"..","sourcesContent":["(() => {\r\n  /* 注意:对于使用了document.write的网站, 加载会出错,因为脚本都是异步加载的,网页内容会被覆盖*/\r\n  window.addEventListener(\"load\", windowloadhandler);\r\n  function windowloadhandler() {\r\n    document.charset = \"UTF-8\";\r\n    window.removeEventListener(\"load\", windowloadhandler);\r\n\r\n    var htmldataboject = new Object();\r\n    Array(...document.querySelectorAll(\"script\")).forEach(e => {\r\n      if (e.src !== \"\") {\r\n        e.src = e.src;\r\n      }\r\n    });\r\n    document.firstElementChild.dataset.href = location.href;\r\n    document.firstElementChild.dataset.pathname = location.pathname;\r\n    console.log(\r\n      \"当前页面的document的href为\" + document.firstElementChild.dataset.href\r\n    );\r\n    console.log(\r\n      \"当前页面的document的pathname为\" +\r\n        document.firstElementChild.dataset.pathname\r\n    );\r\n    // var lasthref;\r\n    //  document.firstElementChild.dataset.href = location.href;\r\n    替换a链接();\r\n    document.addEventListener(\"click\", 替换a链接);\r\n    //   document.addEventListener(\"scroll\", 替换a链接);\r\n    function 替换a链接() {\r\n      document.firstElementChild.dataset.href = location.href;\r\n      document.firstElementChild.dataset.pathname = location.pathname;\r\n      var alinkarr = Array.from(document.getElementsByTagName(\"a\"));\r\n      //   console.log(alinkarr);\r\n      alinkarr.forEach(e => {\r\n        /* 尝试把http和https都替换,因为协议不同导致origin不同 */\r\n        // e.protocol = location.protocol;\r\n        /* 使用hostname代替origin判断 */\r\n        if (\r\n          e.href != \"javascript:;\" &&\r\n          location.hostname === e.hostname &&\r\n          e.pathname !== location.pathname\r\n        ) {\r\n          e.dataset.href = e.href;\r\n          console.log(\"替换a链接\", e);\r\n          e.href = \"javascript:;\";\r\n          e.onclick = () => {\r\n            document.firstElementChild.dataset.href = location.href;\r\n            document.firstElementChild.dataset.pathname = location.pathname;\r\n            动态加载网页内容不刷新(e.dataset.href);\r\n          };\r\n        }\r\n\r\n        /*  e.onclick = () => {\r\n              // lasthref=location.href\r\n              console.log(e.href);\r\n      \r\n              if (location.origin === e.origin) {\r\n                if (e.pathname === location.pathname) {\r\n                  if (e.hash !== location.hash) {\r\n                    return true;\r\n                  } else {\r\n                    return false;\r\n                  }\r\n                } else {\r\n                  history.pushState(undefined, undefined, e.href);\r\n                  console.log(\"执行,history.pushState,成功\");\r\n                  window.onpopstate();\r\n                  return false;\r\n                }\r\n      \r\n                //   return false;\r\n              } else {\r\n                return true;\r\n              }\r\n            }; */\r\n      });\r\n    }\r\n    //   document.onclick();\r\n    var onpopstatehandler = () => {\r\n      console.log(\"onpopstate,执行,动态加载网页内容不刷新\");\r\n      //    document.firstElementChild.dataset.href = document.firstElementChild.dataset.href;\r\n      console.log(\r\n        \"当前的地址栏路径为\" + location.pathname,\r\n        \"当前的网页document路径为\" + document.firstElementChild.dataset.pathname\r\n      );\r\n      if (document.firstElementChild.dataset.pathname !== location.pathname) {\r\n        动态加载网页内容不刷新();\r\n      }\r\n\r\n      替换a链接();\r\n    };\r\n    window.addEventListener(\"popstate\", onpopstatehandler);\r\n    var script总数量 = 0;\r\n    var script完成数量 = 0;\r\n    function script加载完成(urlortext) {\r\n      替换a链接();\r\n      script完成数量++;\r\n      console.log(script完成数量, script总数量);\r\n      console.log(\"script加载完成\", urlortext);\r\n      if (script完成数量 === script总数量) {\r\n        console.log(\"触发window的load事件\");\r\n        setTimeout(() => {\r\n          window.dispatchEvent(new Event(\"load\"));\r\n        }, 200);\r\n        document.firstElementChild.dataset.href = location.href;\r\n        document.firstElementChild.dataset.pathname = location.pathname;\r\n        console.log(\r\n          \"当前页面的document的href为\" + document.firstElementChild.dataset.href\r\n        );\r\n      }\r\n      /*  () => {\r\n              setTimeout(() => {\r\n                try {\r\n                  window.dispatchEvent(new Event(\"load\"));\r\n                } catch (error) {\r\n                  console.log(error);\r\n                }\r\n              }, 300);\r\n            };  */\r\n    }\r\n    function loadscript(fileurl, loadguid = guid(), callback = undefined) {\r\n      var script = document.createElement(\"script\");\r\n      script.dataset.loadid = loadguid;\r\n      script.type = \"text/javascript\";\r\n      script.src = fileurl;\r\n      script.onload = () => {\r\n        callback(fileurl);\r\n      };\r\n      script.async = true;\r\n      script.onerror = () => {\r\n        console.log(\"加载失败\" + fileurl);\r\n      };\r\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\r\n\r\n      console.log(\"添加script到head\", script);\r\n    }\r\n    function loadscripttext(text, loadguid = guid()) {\r\n      var script = document.createElement(\"script\");\r\n      script.onerror = () => {\r\n        console.log(\"加载失败\" + fileurl);\r\n      };\r\n      /*   script.onload = () => {\r\n            callback(text);\r\n          }; */\r\n      /* 用文本创建的script不会执行onload事件 */\r\n      script.innerHTML = text;\r\n      script.type = \"text/javascript\";\r\n      script.dataset.loadid = loadguid;\r\n      script.async = true;\r\n      console.log(\"添加script到head\", script);\r\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\r\n    }\r\n    function loadstyle(fileurl, callback = undefined) {\r\n      var script = document.createElement(\"link\");\r\n      script.dataset.loadid = guid();\r\n      script.rel = \"stylesheet\";\r\n      script.href = fileurl;\r\n      script.onload = callback;\r\n      script.type = \"text/css\";\r\n\r\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\r\n\r\n      console.log(script);\r\n    }\r\n    function guid() {\r\n      return \"xxxxxxxx-xxxx-yxxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function(\r\n        t\r\n      ) {\r\n        var e = (16 * Math.random()) | 0;\r\n        return (\"x\" == t ? e : (3 & e) | 8).toString(16);\r\n      });\r\n    }\r\n    function fetchhandler(t) {\r\n      var loadid = guid();\r\n      document.charset = \"UTF-8\";\r\n      /* 把源代码的编码转成unicode */\r\n      var sr = t;\r\n      //   console.log(sr);\r\n      var myhtmldata = new DOMParser().parseFromString(sr, \"text/html\");\r\n      console.log(myhtmldata.charset);\r\n      myhtmldata.charset = \"UTF-8\";\r\n      htmldataboject[new URL(myhtmldata.URL).pathname] = {\r\n        url: myhtmldata.URL,\r\n        text: sr\r\n      };\r\n      console.log(\"加载过的网页的源代码合集\", htmldataboject);\r\n      console.log(myhtmldata);\r\n      document.title = myhtmldata.title;\r\n      // window.myhtmldata = myhtmldata;\r\n      document.getElementsByTagName(\r\n        \"body\"\r\n      )[0].innerHTML = myhtmldata.getElementsByTagName(\"body\")[0].innerHTML;\r\n      /*  Array.from(document.querySelectorAll(\"link\")).forEach(e => {\r\n        e.parentNode.removeChild(e);\r\n      });\r\n      Array.from(document.querySelectorAll(\"style\")).forEach(e => {\r\n        e.parentNode.removeChild(e);\r\n      });\r\n      Array.from(document.querySelectorAll(\"meta\")).forEach(e => {\r\n        e.parentNode.removeChild(e);\r\n      });\r\n      Array.from(document.querySelectorAll(\"script\")).forEach(e => {\r\n        e.parentNode.removeChild(e);\r\n      }); */\r\n      Array.from(myhtmldata.querySelectorAll(\"link[rel='stylesheet']\")).forEach(\r\n        e => {\r\n          e.dataset.loadid = loadid;\r\n          e.onerror = () => {\r\n            console.log(\"加载失败\" + e.href);\r\n          };\r\n          e.type = \"text/css\";\r\n          e.href = e.href;\r\n          console.log(\"添加css元素到head\", e);\r\n          document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n        }\r\n      );\r\n\r\n      Array.from(myhtmldata.querySelectorAll(\"link\")).forEach(e => {\r\n        e.dataset.loadid = loadid;\r\n\r\n        e.href = e.href;\r\n        console.log(\"添加元素到head\", e);\r\n        document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n      });\r\n\r\n      Array.from(myhtmldata.querySelectorAll(\"style\")).forEach(e => {\r\n        e.type = \"text/css\";\r\n        e.dataset.loadid = loadid;\r\n        console.log(\"添加css元素到head\", e);\r\n        document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n      });\r\n\r\n      Array.from(myhtmldata.querySelectorAll(\"meta\")).forEach(e => {\r\n        e.dataset.loadid = loadid;\r\n        console.log(\"添加元素到head\", e);\r\n        document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n      });\r\n\r\n      /*    document.getElementsByTagName(\r\n        \"body\"\r\n      )[0].innerHTML = myhtmldata.getElementsByTagName(\"body\")[0].innerHTML; */\r\n      script完成数量 = 0;\r\n      script总数量 = Array.from(myhtmldata.querySelectorAll(\"script\")).length;\r\n      Array.from(myhtmldata.querySelectorAll(\"script\")).forEach(e => {\r\n        if (e.type == \"text/javascript\" || \"\" == e.type) {\r\n          e.type = \"text/javascript\";\r\n          if (e.src != \"\") {\r\n            e.src = e.src;\r\n            /* 但是如果有些脚本不重复加载,可能网页出错 */\r\n            /* 不要重复加载javascipt文件,否则可能出问题 */\r\n            loadscript(e.src, loadid, script加载完成);\r\n          } else {\r\n            loadscripttext(e.innerHTML, loadid);\r\n            script完成数量++;\r\n          }\r\n        } else {\r\n          /* 不是javascript文件 */\r\n          if (e.src != \"\") {\r\n            e.src = e.src;\r\n          }\r\n          console.log(\"添加元素到head\", e);\r\n          e.dataset.loadid = loadid;\r\n          script完成数量++;\r\n          document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n        }\r\n\r\n        //////////////////////////////\r\n        //   console.log(\"e.type\",e.type)\r\n        // /* if (e.src) {\r\n        //   e.src = e.src;\r\n        //   if (e.type == \"text/javascript\" || \"\" == e.type) {\r\n        //     loadscript(e.src, loadid, script加载完成);\r\n        //   } else {\r\n        //     console.log(\"添加元素到head\", e);\r\n        //     //   script加载完成();\r\n        //     script完成数量++;\r\n        //     document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n        //   }\r\n        // } else {\r\n        //   // console.log(\"script-innertext\", e.innerText.replace(/\\n/g,\";\"));\r\n        //   /* if (\"\"==e.type) {\r\n\r\n        //     e.type = \"text/javascript\";\r\n        //   } */\r\n        //   e.onerror = () => {\r\n        //     console.log(\"加载失败\" + e.src);\r\n        //   };\r\n        //   e.dataset.loadid = loadid;\r\n        //   // e.async = true;\r\n        //   if (e.type == \"text/javascript\" || \"\" == e.type) {\r\n        //     e.type = \"text/javascript\";\r\n        //     loadscripttext(e.innerHTML, loadid);\r\n        //     //   script加载完成();\r\n        //     script完成数量++;\r\n        //     /*  var script = document.createElement(\"script\");\r\n        //         script.onload = script加载完成;\r\n        //         script.innerHTML = e.innerHTML;\r\n        //         script.type = e.type;\r\n        //         script.dataset.loadid = e.dataset.loadid;\r\n        //         console.log(script);\r\n        //         document.getElementsByTagName(\"head\")[0].appendChild(script); */\r\n        //   } else {\r\n        //     console.log(\"添加元素到head\", e);\r\n        //     //   script加载完成();\r\n        //     script完成数量++;\r\n        //     document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n        //   }\r\n        // } */\r\n      });\r\n      /*  Array.from(\r\n        document.getElementsByTagName(\"body\")[0].querySelectorAll(\"script\")\r\n      ).forEach(e => {\r\n        e.parentNode.removeChild(e);\r\n      }); */\r\n\r\n      Array(\r\n        ...document.querySelectorAll(\"link\"),\r\n        ...document.querySelectorAll(\"style\"),\r\n        ...document.querySelectorAll(\"meta\"),\r\n        ...document.querySelectorAll(\"script\")\r\n      ).forEach(e => {\r\n        if (loadid != e.dataset.loadid) {\r\n          e.parentNode.removeChild(e);\r\n          console.log(\"删除旧元素\", e);\r\n        }\r\n      });\r\n      /* Array.from(document.querySelectorAll(\"style\")).forEach(e => {\r\n        if (!e.dataset.loadid) {\r\n          e.parentNode.removeChild(e);\r\n          console.log(\"删除旧元素\", e);\r\n        }\r\n      });\r\n      Array.from(document.querySelectorAll(\"meta\")).forEach(e => {\r\n        if (!e.dataset.loadid) {\r\n          e.parentNode.removeChild(e);\r\n          console.log(\"删除旧元素\", e);\r\n        }\r\n      });\r\n      Array.from(document.querySelectorAll(\"script\")).forEach(e => {\r\n        if (!e.dataset.loadid) {\r\n          e.parentNode.removeChild(e);\r\n          console.log(\"删除旧元素\", e);\r\n        }\r\n      });*/\r\n\r\n      // document.charset=\"UTF-8\"\r\n      /*  Array.from(myhtmldata.querySelectorAll(\"script\")).forEach(e => {\r\n            if (e.src) {\r\n              e.src = e.src;\r\n              loadscript(e.src);\r\n            } else {\r\n              if (!e.type) {\r\n                e.type = \"text/javascript\";\r\n              }\r\n              e.onerror = () => {\r\n                console.log(\"加载失败\" + e.src);\r\n              };\r\n              e.dataset.loadid = loadid;\r\n              e.async = true;\r\n              //   console.log(e.src)\r\n              document.getElementsByTagName(\"head\")[0].appendChild(e);\r\n            }\r\n          }); */\r\n      /* setTimeout(() => {\r\n            try {\r\n              window.dispatchEvent(new Event(\"load\"));\r\n            } catch (error) {\r\n              console.log(error);\r\n            }\r\n          }, 300); */\r\n    }\r\n\r\n    function 动态加载网页内容不刷新(url = location.href) {\r\n      document.charset = \"UTF-8\";\r\n      /*  if (typeof url === \"undefined\") {\r\n        url = location.href;\r\n      } else  */\r\n      url = new URL(url);\r\n      url.protocal = location.protocol;\r\n      if (\r\n        (location.hostname === url.hostname &&\r\n          url.pathname !== location.pathname) ||\r\n        url.pathname !== document.firstElementChild.dataset.pathname\r\n      ) {\r\n        console.log(\"动态加载网页内容不刷新,执行\" + url);\r\n        // var urlorighin = new URL(url).origin;\r\n        //    document.firstElementChild.dataset.href = location.href;\r\n        if (url.pathname !== location.pathname) {\r\n          history.pushState(undefined, undefined, url);\r\n        }\r\n\r\n        var nowurl = location.href;\r\n        console.log(\r\n          \"替换当前的网址\" + document.firstElementChild.dataset.href,\r\n          \"改成\",\r\n          nowurl\r\n        );\r\n        try {\r\n          fetch(url)\r\n            .then(r => {\r\n              console.log(r);\r\n              return r.text();\r\n            })\r\n            .then(fetchhandler);\r\n        } catch (error) {\r\n          console.error(error);\r\n          if (url.protocal === \"https:\") {\r\n            url.protocal = \"http:\";\r\n          } else {\r\n            url.protocal = \"https:\";\r\n          }\r\n\r\n          fetch(url)\r\n            .then(r => {\r\n              console.log(r);\r\n              return r.text();\r\n            })\r\n            .then(fetchhandler);\r\n        }\r\n      } else {\r\n        console.log(\r\n          \"动态加载网页内容不刷新,不执行\" + \"原网页与现在的网址相同不刷新\",\r\n          document.firstElementChild.dataset.href,\r\n          location.href\r\n        );\r\n      }\r\n    }\r\n  }\r\n})();\r\n"]}